<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kanda — JW Player High CPM</title>

<!-- JW Player CDN -->
<script src="https://cdn.jwplayer.com/libraries/your-library-key.js"></script>

<style>
  body { margin:0; background:#121212; color:#eee; font-family:Arial,Helvetica,sans-serif; }
  .page { max-width:900px; margin:20px auto; padding:12px; }
  h1 { color:#ff6666; text-align:center; margin-bottom:12px; }

  /* Sticky mini-player */
  #stickyContainer {
    position:fixed; right:12px; bottom:12px; width:320px; height:180px;
    background:#000; z-index:20000; box-shadow:0 10px 30px rgba(0,0,0,0.6);
    border-radius:8px; overflow:hidden; display:none;
  }
  #stickyHeader { height:28px; background:rgba(0,0,0,0.5); color:#fff; display:flex; align-items:center; justify-content:center; font-size:13px; }
</style>
</head>
<body>
<div class="page">
  <h1>Kanda — High CPM JW Player</h1>

  <!-- Main JW Player container -->
  <div id="mainPlayer">Loading player...</div>
</div>

<!-- Sticky Mini-Player -->
<div id="stickyContainer">
  <div id="stickyHeader">Sponsored</div>
  <div id="stickyPlayer"></div>
</div>

<script>
const videoUrl = "https://np4248.github.io/videoxx/video3.mp4";

// ExoClick / Adsterra VAST tags
const VAST_CHAIN = [
  "https://s.magsrv.com/v1/vast.php?idzone=5755632&ex_av=name",
  "https://s.magsrv.com/v1/vast.php?idzone=5757688&ex_av=name",
  "https://s.magsrv.com/v1/vast.php?idzone=5757692&ex_av=name",
  "https://s.magsrv.com/v1/vast.php?idzone=5757698&ex_av=name"
];

// Priority for pre, mid, post, pause, sticky
const PRIORITY_START = { pre:0, mid:1, post:2, pause:3, sticky:0 };

function rotatedList(roll){
  const start = PRIORITY_START[roll]%VAST_CHAIN.length;
  const out=[];
  for(let i=0;i<VAST_CHAIN.length;i++) out.push(VAST_CHAIN[(start+i)%VAST_CHAIN.length]);
  return out;
}

// ---------------- Main JW Player ----------------
const playerInstance = jwplayer("mainPlayer").setup({
  file: videoUrl,
  width: "100%",
  aspectratio: "16:9",
  autostart: false,
  advertising: {
    client: "vast",
    schedule: [
      { offset: "pre", tag: rotatedList('pre')[0] },
      { offset: "50%", tag: rotatedList('mid')[0] },
      { offset: "post", tag: rotatedList('post')[0] }
    ]
  }
});

// ---------------- Pause Overlay Ad ----------------
playerInstance.on('pause', function(){
  // Optional: could trigger a secondary JW Player for pause ads in overlay
  console.log("Video paused - pause ad can trigger here");
});

// ---------------- Sticky Mini-Player ----------------
let stickyShown = false;
playerInstance.on('time', function(e){
  if(!stickyShown && e.position >= playerInstance.getDuration()*0.5){
    stickyShown=true;
    document.getElementById("stickyContainer").style.display="block";
    jwplayer("stickyPlayer").setup({
      file: videoUrl,
      width: "100%",
      height: "100%",
      autostart: true,
      mute: true,
      advertising: { client: "vast", tag: rotatedList('sticky')[0] }
    });
  }
});
</script>
</body>
</html>
